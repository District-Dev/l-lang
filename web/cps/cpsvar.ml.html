<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>cpsvar.ml</TITLE>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.10">
<STYLE type="text/css">
.li-itemize{margin:1ex 0ex;}
.li-enumerate{margin:1ex 0ex;}
.dd-description{margin:0ex 0ex 1ex 4ex;}
.dt-description{margin:0ex;}
.toc{list-style:none;}
.thefootnotes{text-align:left;margin:0ex;}
.dt-thefootnotes{margin:0em;}
.dd-thefootnotes{margin:0em 0em 0em 2em;}
.footnoterule{margin:1em auto 1em 0px;width:50%;}
.caption{padding-left:2ex; padding-right:2ex; margin-left:auto; margin-right:auto}
.title{margin:2ex auto;text-align:center}
.center{text-align:center;margin-left:auto;margin-right:auto;}
.flushleft{text-align:left;margin-left:0ex;margin-right:auto;}
.flushright{text-align:right;margin-left:auto;margin-right:0ex;}
DIV TABLE{margin-left:inherit;margin-right:inherit;}
PRE{text-align:left;margin-left:0ex;margin-right:auto;}
BLOCKQUOTE{margin-left:4ex;margin-right:4ex;text-align:left;}
TD P{margin:0px;}
.boxed{border:1px solid black}
.textboxed{border:1px solid black}
.vbar{border:none;width:2px;background-color:black;}
.hbar{border:none;height:2px;width:100%;background-color:black;}
.hfill{border:none;height:1px;width:200%;background-color:black;}
.vdisplay{border-collapse:separate;border-spacing:2px;width:auto; empty-cells:show; border:2px solid red;}
.vdcell{white-space:nowrap;padding:0px;width:auto; border:2px solid green;}
.display{border-collapse:separate;border-spacing:2px;width:auto; border:none;}
.dcell{white-space:nowrap;padding:0px;width:auto; border:none;}
.dcenter{margin:0ex auto;}
.vdcenter{border:solid #FF8000 2px; margin:0ex auto;}
.minipage{text-align:left; margin-left:0em; margin-right:auto;}
.marginpar{border:solid thin black; width:20%; text-align:left;}
.marginparleft{float:left; margin-left:0ex; margin-right:1ex;}
.marginparright{float:right; margin-left:1ex; margin-right:0ex;}
.theorem{text-align:left;margin:1ex auto 1ex 0ex;}
.part{margin:2ex auto;text-align:center}
</STYLE>
</HEAD>
<BODY >
<!--HEVEA command line is: /usr/bin/hevea -I /usr/share/texmf/tex/latex/misc ocamlweb.sty cpsvar.ml.tex -->
<!--CUT DEF section 1 --><!--TOC section Module Cpsvar-->
<H2 CLASS="section"><!--SEC ANCHOR -->Module Cpsvar</H2><!--SEC END --><P>
<B>1.</B> 
<A NAME="src/cps/cpsvar.ml:0"></A><A NAME="src/cps/cpsvar.ml:41"></A>This file implements links between variables, following the
"Compiling with continuations, continued" paper by Andrew Kennedy,
and "Shrinking lambda expressions in linear time", by Andrew Appel
and Trevor Jim.</P><P>Occurrences are linked to one another into a doubly-linked list,
such that the doubly-linked list represents the set of all
occurrences of a variable. A variable is linked to one of its
occurrence (and thus to the set of all occurrences of the
variable). This allows adding occurrence, removing occurence, and
knowing if there is 0,1, or more occurrence to a variable, in O(1)
time.</P><P>The set of all occurrences of all variables is partitionned into
same-binder equivalence classes using a union-find data structure,
i.e. all the members of a partition are occurrences of the same
variable. The description of the partition is the binding variable
itself. This allows near-constant time access to the binding
variable, and merging of occurrence sets. 
<BR><A NAME="src/cps/cpsvar.ml:1040"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Union_find</span> = <span style="color: #228b22; ">Union_find.Safe</span></P><P></code></div>
Note: a minor problem here is that the unique id is shared between
all applications of Cpsvar.Make, but this is not a huge issue. 
<BR><A NAME="src/cps/cpsvar.ml:1218"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">UniqueId</span> = <span style="color: #228b22; ">Unique.Make</span>(<span style="color: #0000ff; font-weight: bold;">struct</span> <span style="color: #0000ff; font-weight: bold;">end</span>)<BR></code></div><B>2.</B> 
<A NAME="src/cps/cpsvar.ml:1265"></A>Variables link to their description, and to one occurrence (if
there is one). We also add a unique id to allow variable comparison.
Also, unique variables remove any need for alpha conversion. 
<BR><A NAME="src/cps/cpsvar.ml:1467"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">type</span> (&#X3B1;,&#X3B2;) variable =<BR>    
{ <span style="color: #a020f0; ">mutable</span> var_desc: &#X3B1; initialized;<BR>      
<span style="color: #a020f0; ">mutable</span> occurrences:(&#X3B1;, &#X3B2;) occurrence <span style="color: #228b22; ">option</span>;<BR>      
var_id: <span style="color: #228b22; ">UniqueId.</span>t;<BR>      
<span style="color: #a020f0; ">mutable</span> occur_nb: <span style="color: #228b22; ">int</span> }</P><P></code></div>
Occurrences need a description; a "union-find link" (to retrieve
the binding variable, which is the description of the union-find
partition); and the links of the doubly-linked lists. We also
number the occurrences of a variable, to help in debugging and ease
comparison between occurrences. 
<BR><A NAME="src/cps/cpsvar.ml:1952"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">and</span> (&#X3B1;,&#X3B2;) occurrence = <BR>    
{ <span style="color: #a020f0; ">mutable</span> occur_desc: &#X3B2; initialized;<BR>      
<span style="color: #a020f0; ">mutable</span> link_var: ((&#X3B1;, &#X3B2;) variable,(&#X3B1;, &#X3B2;) occurrence) <span style="color: #228b22; ">Union_find.</span>link;<BR>      
<span style="color: #a020f0; ">mutable</span> next_occurrence:(&#X3B1;, &#X3B2;) occurrence;<BR>      
<span style="color: #a020f0; ">mutable</span> previous_occurrence:(&#X3B1;, &#X3B2;) occurrence;<BR>      
occur_id: <span style="color: #228b22; ">int</span> }</P><P></code></div>
We have to check that the user does not retrieve the description
until the variable is initialized, or that it does not overwrite an
already initialized description. 
<BR><A NAME="src/cps/cpsvar.ml:2408"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">and</span> &#X3B1; initialized = <span style="color: #228b22; ">Undef</span> &#X2223; <span style="color: #228b22; ">Initialized_to</span> <span style="color: #a52a2a; ">of</span> &#X3B1;<BR></code></div><B>3.</B> 
<A NAME="src/cps/cpsvar.ml:2464"></A>The CPSVar functor takes a DESCRIPTION argument as explained in the interface. 
<BR><A NAME="src/cps/cpsvar.ml:2549"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>

<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #0000ff; font-weight: bold;">type</span> <span style="color: #228b22; ">DESCRIPTION</span> = <span style="color: #0000ff; font-weight: bold;">sig</span><BR>  
<span style="color: #0000ff; font-weight: bold;">type</span> variable_description<BR>  
<span style="color: #0000ff; font-weight: bold;">type</span> occurrence_description<BR>  
<span style="color: #0000ff; font-weight: bold;">val</span> var_prefix:<span style="color: #228b22; ">string</span><BR>
<span style="color: #0000ff; font-weight: bold;">end</span></P><P><A NAME="src/cps/cpsvar.ml:2667"></A>
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Make</span>(<span style="color: #228b22; ">Desc</span>:<span style="color: #228b22; ">DESCRIPTION</span>) = <span style="color: #0000ff; font-weight: bold;">struct</span></P><P><A NAME="src/cps/cpsvar.ml:2707"></A>  
<span style="color: #0000ff; font-weight: bold;">type</span> var = (<span style="color: #228b22; ">Desc.</span>variable_description, <span style="color: #228b22; ">Desc.</span>occurrence_description) variable<BR>  
<span style="color: #0000ff; font-weight: bold;">type</span> occur = (<span style="color: #228b22; ">Desc.</span>variable_description, <span style="color: #228b22; ">Desc.</span>occurrence_description) occurrence<BR></code></div><B>4.</B> 
<A NAME="src/cps/cpsvar.ml:2874"></A>Occurrences contain a link variable, used by the union-find
functor. The description of a partition of an occurrence <code>occur</code>
is the variable <code>var</code> for which <code>occur</code> is an occurrence. 
<BR><A NAME="src/cps/cpsvar.ml:3070"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
  
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Var_union_find</span> = <span style="color: #228b22; ">Union_find.Make</span>(<span style="color: #0000ff; font-weight: bold;">struct</span><BR>    
<span style="color: #0000ff; font-weight: bold;">type</span> description = var<BR>    
<span style="color: #0000ff; font-weight: bold;">type</span> element = occur<BR>    
<span style="color: #0000ff; font-weight: bold;">let</span> set f v = f.link_var &#X2190; v<BR>    
<span style="color: #0000ff; font-weight: bold;">let</span> get f = f.link_var<BR>  
<span style="color: #0000ff; font-weight: bold;">end</span>)</P><P></code></div>  
The Union-find module requires a "union-find data structure"
(ufds) as its first argument. Ideally, we should have one such
ufds per CPS term, as a variable and all its occurrences cannot
be shared between several terms. However, using a single ufds for
all terms in a global variable is more practical (no need to pass
an additional argument). Moreover, confusion between partitions
of several terms should be relatively easy to avoid, so checking
that with several ufds is not absolutely necessary. 
<BR><A NAME="src/cps/cpsvar.ml:3784"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
  
<span style="color: #0000ff; font-weight: bold;">let</span> ufds = <span style="color: #228b22; ">Var_union_find.</span>create()</P><P><A NAME="src/cps/cpsvar.ml:3824"></A>  
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Var</span> = <span style="color: #0000ff; font-weight: bold;">struct</span><BR></code></div><B>5.</B> 
<A NAME="src/cps/cpsvar.ml:3853"></A>The tryptic make/description/set_description allows building
circular structures without simultaneous definitions.
<code>var_counter</code> provides unique identifiers when displaying
variables. 
<BR><A NAME="src/cps/cpsvar.ml:4061"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> make() =<BR>      
{ var_desc = <span style="color: #228b22; ">Undef</span>;<BR>        
occurrences = <span style="color: #228b22; ">None</span>;<BR>        
var_id = <span style="color: #228b22; ">UniqueId.</span>fresh();<BR>        
occur_nb = 0 } </P><P><A NAME="src/cps/cpsvar.ml:4194"></A>    
<span style="color: #0000ff; font-weight: bold;">let</span> description b = <span style="color: #a020f0; ">match</span> b.var_desc <span style="color: #a020f0; ">with</span><BR>      
&#X2223; <span style="color: #228b22; ">Initialized_to</span>(d) &#X2192; d<BR>      
&#X2223; <span style="color: #228b22; ">Undef</span> &#X2192; <span style="color: #a020f0; ">assert</span> <span style="color: #a020f0; ">false</span> <span style="color: #b22222">(&#X2217;  Trying to access an uninitialized description.  &#X2217;)</span></P><P><A NAME="src/cps/cpsvar.ml:4356"></A>    
<span style="color: #0000ff; font-weight: bold;">let</span> set_description b d = <span style="color: #a020f0; ">match</span> b.var_desc <span style="color: #a020f0; ">with</span><BR>      
&#X2223; <span style="color: #228b22; ">Initialized_to</span>(d) &#X2192; <span style="color: #a020f0; ">assert</span> <span style="color: #a020f0; ">false</span> <span style="color: #b22222">(&#X2217;  Description already initialized.  &#X2217;)</span> <BR>      
&#X2223; <span style="color: #228b22; ">Undef</span> &#X2192; b.var_desc &#X2190; <span style="color: #228b22; ">Initialized_to</span>(d)<BR></code></div><B>6.</B> 
<A NAME="src/cps/cpsvar.ml:4550"></A>Occurrence number can return in O(1) whether a variable has
no, one, or more than one occurrence. For that we must not
return the list of occurrence if there are several; instead the
user must then use the <code>fold_on_occurrences</code> function. 
<BR><A NAME="src/cps/cpsvar.ml:4811"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">type</span> occurrence_number = <BR>      
&#X2223; <span style="color: #228b22; ">No_occurrence</span><BR>      
&#X2223; <span style="color: #228b22; ">One_occurrence</span> <span style="color: #a52a2a; ">of</span> occur<BR>      
&#X2223; <span style="color: #228b22; ">Several_occurrences</span></P><P><A NAME="src/cps/cpsvar.ml:4924"></A>    
<span style="color: #0000ff; font-weight: bold;">let</span> occurrence_number var = <BR>      
<span style="color: #a020f0; ">match</span> var.occurrences <span style="color: #a020f0; ">with</span><BR>        
&#X2223; <span style="color: #228b22; ">None</span> &#X2192; <span style="color: #228b22; ">No_occurrence</span><BR>        
&#X2223; <span style="color: #228b22; ">Some</span>(occ) &#X2192; <BR>          
<span style="color: #a020f0; ">if</span> occ.previous_occurrence &#X2261; occ<BR>          
<span style="color: #a020f0; ">then</span> <span style="color: #0000ff; font-weight: bold;">begin</span><BR>            
<span style="color: #a020f0; ">assert</span> (occ.next_occurrence &#X2261; occ);<BR>            
<span style="color: #228b22; ">One_occurrence</span> occ<BR>          
<span style="color: #0000ff; font-weight: bold;">end</span><BR>          
<span style="color: #a020f0; ">else</span> <span style="color: #228b22; ">Several_occurrences</span></P><P><A NAME="src/cps/cpsvar.ml:5243"></A>    
<span style="color: #0000ff; font-weight: bold;">let</span> fold_on_occurrences var init f = <BR>      
<span style="color: #a020f0; ">match</span> var.occurrences <span style="color: #a020f0; ">with</span><BR>        
&#X2223; <span style="color: #228b22; ">None</span> &#X2192; init<BR>        
&#X2223; <span style="color: #228b22; ">Some</span>(occ) &#X2192; <BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> <span style="color: #0000ff; font-weight: bold;">rec</span> loop value cur = <BR>            
<span style="color: #a020f0; ">if</span> cur &#X2261; occ<BR>            
<span style="color: #a020f0; ">then</span> f value cur<BR>            
<span style="color: #a020f0; ">else</span> loop (f value cur) cur.next_occurrence<BR>          
<span style="color: #0000ff; font-weight: bold;">in</span> loop init occ.next_occurrence<BR></code></div><B>7.</B> 
<A NAME="src/cps/cpsvar.ml:5564"></A>Utility functions. Comparison is done using the unique ids;
this allows faster comparisons, and avoid looping indefinitely
when there are cyclic references between a <code>var</code> and its
<code>description</code>.
<BR><A NAME="src/cps/cpsvar.ml:5781"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> to_string bv = <span style="color: #228b22; ">Desc.</span>var_prefix ^ (<span style="color: #228b22; ">UniqueId.</span>to_string bv.var_id)</P><P><A NAME="src/cps/cpsvar.ml:5856"></A>    
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Map</span> = <span style="color: #228b22; ">Map.Make</span>(<span style="color: #0000ff; font-weight: bold;">struct</span><BR>      
<span style="color: #0000ff; font-weight: bold;">type</span> t = var<BR>      
<span style="color: #0000ff; font-weight: bold;">let</span> compare a b = compare a.var_id b.var_id<BR>    
<span style="color: #0000ff; font-weight: bold;">end</span>)</P><P><A NAME="src/cps/cpsvar.ml:5968"></A>    
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Set</span> = <span style="color: #228b22; ">Set.Make</span>(<span style="color: #0000ff; font-weight: bold;">struct</span><BR>      
<span style="color: #0000ff; font-weight: bold;">type</span> t = var<BR>      
<span style="color: #0000ff; font-weight: bold;">let</span> compare a b = compare a.var_id b.var_id<BR>    
<span style="color: #0000ff; font-weight: bold;">end</span>)</P><P><A NAME="src/cps/cpsvar.ml:6080"></A>  
<span style="color: #0000ff; font-weight: bold;">end</span></P><P><A NAME="src/cps/cpsvar.ml:6089"></A>  
<span style="color: #0000ff; font-weight: bold;">module</span> <span style="color: #228b22; ">Occur</span> = <BR>  
<span style="color: #0000ff; font-weight: bold;">struct</span><BR></code></div><B>8.</B> 
<A NAME="src/cps/cpsvar.ml:6123"></A>Create a new occurrence of VAR, i.e. add it to the
doubly-linked list of all the occurrences of VAR, and to the
union-find partition of the occurrences of VAR. 
<BR><A NAME="src/cps/cpsvar.ml:6300"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> make var = <BR>      
<span style="color: #b22222">(&#X2217;  Create an initial self-linked occurrence of var.  &#X2217;)</span><BR>      
<span style="color: #0000ff; font-weight: bold;">let</span> self_linked_occur var = <BR>        
var.occur_nb &#X2190; var.occur_nb + 1;<BR>        
<span style="color: #0000ff; font-weight: bold;">let</span> <span style="color: #0000ff; font-weight: bold;">rec</span> occur = { occur_desc = <span style="color: #228b22; ">Undef</span>;<BR>                          
link_var = <span style="color: #228b22; ">Union_find.</span>empty_link;<BR>                          
next_occurrence = occur;<BR>                          
previous_occurrence = occur;<BR>                          
occur_id = var.occur_nb; } <BR>        
<span style="color: #0000ff; font-weight: bold;">in</span> occur<BR>      
<span style="color: #0000ff; font-weight: bold;">in</span><BR>      
<span style="color: #a020f0; ">match</span> var.occurrences <span style="color: #a020f0; ">with</span><BR>        
<span style="color: #b22222">(&#X2217;  If this is the first occurrence of var.  &#X2217;)</span><BR>        
&#X2223; <span style="color: #228b22; ">None</span> &#X2192; <BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> new_occur = self_linked_occur var <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
<span style="color: #228b22; ">Var_union_find.</span>singleton ufds new_occur var;<BR>          
var.occurrences &#X2190; <span style="color: #228b22; ">Some</span>(new_occur);<BR>          
new_occur<BR>        
<span style="color: #b22222">(&#X2217;  Else there are already some occurrences of var.  &#X2217;)</span><BR>        
&#X2223; <span style="color: #228b22; ">Some</span>(existing_occur) &#X2192; <BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> new_occur = self_linked_occur var <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
<span style="color: #b22222">(&#X2217;  Insert new between existing and existing.next.  &#X2217;)</span><BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> following_occur = existing_occur.next_occurrence <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> new_occur = { new_occur<BR>                            
<span style="color: #a020f0; ">with</span> next_occurrence = following_occur;<BR>                              
previous_occurrence = existing_occur } <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
existing_occur.next_occurrence &#X2190; new_occur;<BR>          
following_occur.previous_occurrence &#X2190; new_occur;<BR>          
<span style="color: #b22222">(&#X2217;  Merge new to the partition of occurrences of var.  &#X2217;)</span><BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> new_part = <span style="color: #228b22; ">Var_union_find.</span>singleton ufds new_occur var <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
<span style="color: #0000ff; font-weight: bold;">let</span> existing_part = (<span style="color: #228b22; ">Var_union_find.</span>find ufds existing_occur) <span style="color: #0000ff; font-weight: bold;">in</span><BR>          
<span style="color: #228b22; ">Var_union_find.</span>union ufds new_part existing_part var;<BR>          
new_occur</P><P></code></div>    
Returns the variable of which <code>occur</code> is an occurrence. 
<BR><A NAME="src/cps/cpsvar.ml:7965"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> binding_variable occur =<BR>      
<span style="color: #0000ff; font-weight: bold;">let</span> part = <span style="color: #228b22; ">Var_union_find.</span>find ufds occur <span style="color: #0000ff; font-weight: bold;">in</span><BR>      
<span style="color: #228b22; ">Var_union_find.</span>description ufds part</P><P></code></div>    
Similarly to <code><span style="color: #228b22; ">Var</span></code>, description can be get and set only once. 
<BR><A NAME="src/cps/cpsvar.ml:8168"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> description b = <span style="color: #a020f0; ">match</span> b.occur_desc <span style="color: #a020f0; ">with</span><BR>      
&#X2223; <span style="color: #228b22; ">Initialized_to</span>(d) &#X2192; d<BR>      
&#X2223; <span style="color: #228b22; ">Undef</span> &#X2192; <span style="color: #a020f0; ">assert</span> <span style="color: #a020f0; ">false</span> <span style="color: #b22222">(&#X2217;  Trying to access an uninitialized description.  &#X2217;)</span></P><P><A NAME="src/cps/cpsvar.ml:8332"></A>    
<span style="color: #0000ff; font-weight: bold;">let</span> set_description b d = <span style="color: #a020f0; ">match</span> b.occur_desc <span style="color: #a020f0; ">with</span><BR>      
&#X2223; <span style="color: #228b22; ">Initialized_to</span>(d) &#X2192; <span style="color: #a020f0; ">assert</span> <span style="color: #a020f0; ">false</span> <span style="color: #b22222">(&#X2217;  Description already initialized.  &#X2217;)</span><BR>      
&#X2223; <span style="color: #228b22; ">Undef</span> &#X2192; b.occur_desc &#X2190; <span style="color: #228b22; ">Initialized_to</span>(d)</P><P></code></div>    
We suffix the name of the variable by the occurrence number,
which may be useful to follow code transformations steps. 
<BR><A NAME="src/cps/cpsvar.ml:8659"></A>
<div style="border: solid 1px gray; background:#eeeeee;
            margin: 0.5em 1em 0.5em 1em;
            padding: 0.5em 1em 0.5em 1em;
            font-family:mono"><code>
    
<span style="color: #0000ff; font-weight: bold;">let</span> to_string occur = <BR>      
<span style="color: #0000ff; font-weight: bold;">let</span> bv = binding_variable occur <span style="color: #0000ff; font-weight: bold;">in</span><BR>      
(<span style="color: #228b22; ">Var.</span>to_string bv) ^ <span style="color: #8b2252; ">"_"</span> ^ (string_of_int occur.occur_id)</P><P><A NAME="src/cps/cpsvar.ml:8793"></A>  
<span style="color: #0000ff; font-weight: bold;">end</span></P><P><A NAME="src/cps/cpsvar.ml:8800"></A>
<span style="color: #0000ff; font-weight: bold;">end</span><BR><BR></code></div></P><!--CUT END -->
<!--HTMLFOOT-->
<!--ENDHTML-->
<!--FOOTER-->
<HR SIZE=2><BLOCKQUOTE CLASS="quote"><EM>This document was translated from L<sup>A</sup>T<sub>E</sub>X by
</EM><A HREF="http://hevea.inria.fr/index.html"><EM>H</EM><EM><FONT SIZE=2><sup>E</sup></FONT></EM><EM>V</EM><EM><FONT SIZE=2><sup>E</sup></FONT></EM><EM>A</EM></A><EM>.</EM></BLOCKQUOTE></BODY>
</HTML>
